<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper">

	<select id="Login" parameterType = "java.lang.String" resultType = "map">
		select s_email,s_id,s_pw,s_shape from SIGNUP where s_id = #{value}
	</select>
	
	<select id = "idExit" parameterType = "map" resultType = "int">
	SELECT NVL((SELECT 1 as status FROM dual WHERE EXISTS 
	(SELECT S_ID FROM signup WHERE s_id=#{f_id} AND rownum=1)),0) status
        FROM dual
	</select>
	
	<select id = "EmailExit" parameterType = "map" resultType = "int">
	SELECT NVL((SELECT 1 as status FROM dual WHERE EXISTS 
	(SELECT S_ID FROM signup WHERE s_email=#{f_email} AND rownum=1)),0) status
        FROM dual
	</select>
	
	<!-- 네아로 카카오 연동시 유저의 정보를 가져온다.  -->
	<select id = "UserInfoEmail" parameterType = "java.lang.String" resultType = "map">
	select s_email,s_id,s_pw,s_kinds,s_shape,s_date,s_token from SIGNUP where s_email = #{value}
	</select>
	
	<insert id="Join" parameterType="map">
		insert into SIGNUP(s_email,s_id,s_pw,s_shape,s_kinds,s_date) values(#{j_email},#{j_id},#{j_pw},#{s_shape},#{radio},to_char(sysdate,'YYYY/MM/DDHH24:MI:SS'))
	</insert> 
	
	<insert id="AJoin" parameterType="map">
		insert into SIGNUP(s_email,s_id,s_pw) values(#{j_email},#{j_id},#{j_pw})
	</insert> 
	
	<insert id="JoinCapchar" parameterType="map">
		insert into SIGNUP(s_email,s_id,s_shape,s_Token,s_kinds,s_date) values(#{j_email},#{j_id},#{j_shape},#{j_token},#{radio},to_char(sysdate,'YYYY/MM/DDHH24:MI:SS'))
	</insert> 

  <update id="proc_ClientUpdate" statementType="CALLABLE" parameterType="hashmap">
        {  call proc_ClientUpdate(
                #{f_file},
                #{f_dropdown},
                #{f_name},
                #{f_gender},
                #{address},
                #{f_email},
                #{phone},
                #{c_phone}
            )
        }
    </update>
<insert id="ClientInsert" parameterType="java.lang.String">
	insert into CLIENT(c_no,s_email) values(seq_cno.NEXTVAL,#{value})
</insert> 

    <select id = "ClientInfo" parameterType = "java.lang.String" resultType = "map">
	select c_no,c_phone,c_name,c_businessnumber,c_operator,c_file,s_email,c_addr,c_gender from CLIENT  where s_email = #{value}
	</select>
	
	<select id = "CEmailExit" parameterType = "java.lang.String" resultType = "int">
	    SELECT NVL((SELECT 1 as status FROM dual WHERE EXISTS 
    (SELECT s_email FROM CLIENT  WHERE s_email=#{value} AND rownum=1)),0) status
        FROM dual
	</select>
	
	<select id = "Pwcheck" parameterType = "map" resultType = "java.lang.String">
       select s_pw from SIGNUP where s_email = #{s_email}
  
	</select>

	<update id = "PwUpdate" parameterType = "map">
    	update SIGNUP set s_pw = #{pw2} where s_email = #{s_email}
	</update>
	<delete id = "UserExcape" parameterType = "map">
    	delete SIGNUP where s_email = #{s_email} and s_pw = #{password}
	</delete>
</mapper>